// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

library NTT_MLDSA_Zetas {
    uint256 internal constant Q = 8380417;
    uint256 internal constant N = 256;
    uint256 internal constant N_INV = 8347681;

    /// @notice Повертає zeta[i] для ML-DSA-65 NTT.
    /// @dev Значення взяті з робочого варіанту (твій останній if/else).
    function getZeta(uint256 i) internal pure returns (uint256 z) {
        unchecked {
            if (i >= 256) revert("Zeta index out of range");

            assembly {
                switch i
                case 0 { z := 1 }
                case 1 { z := 4808194 }
                case 2 { z := 3765607 }
                case 3 { z := 3761513 }
                case 4 { z := 5178923 }
                case 5 { z := 5496691 }
                case 6 { z := 5234739 }
                case 7 { z := 5178987 }
                case 8 { z := 7778734 }
                case 9 { z := 3542485 }
                case 10 { z := 2682288 }
                case 11 { z := 2129892 }
                case 12 { z := 3764867 }
                case 13 { z := 7375178 }
                case 14 { z := 557458 }
                case 15 { z := 7159240 }
                case 16 { z := 5010068 }
                case 17 { z := 4317364 }
                case 18 { z := 2663378 }
                case 19 { z := 6705802 }
                case 20 { z := 4855975 }
                case 21 { z := 7946292 }
                case 22 { z := 676590 }
                case 23 { z := 7044481 }
                case 24 { z := 5152541 }
                case 25 { z := 1714295 }
                case 26 { z := 2453983 }
                case 27 { z := 1460718 }
                case 28 { z := 7737789 }
                case 29 { z := 4795319 }
                case 30 { z := 2815639 }
                case 31 { z := 2283733 }
                case 32 { z := 3602218 }
                case 33 { z := 3182878 }
                case 34 { z := 2740543 }
                case 35 { z := 4793971 }
                case 36 { z := 5269599 }
                case 37 { z := 2101410 }
                case 38 { z := 3704823 }
                case 39 { z := 1159875 }
                case 40 { z := 394148 }
                case 41 { z := 928749 }
                case 42 { z := 1095468 }
                case 43 { z := 4874037 }
                case 44 { z := 2071829 }
                case 45 { z := 4361428 }
                case 46 { z := 3241972 }
                case 47 { z := 2156050 }
                case 48 { z := 3415069 }
                case 49 { z := 1759347 }
                case 50 { z := 7562881 }
                case 51 { z := 4805951 }
                case 52 { z := 3756790 }
                case 53 { z := 6444618 }
                case 54 { z := 6663429 }
                case 55 { z := 4430364 }
                case 56 { z := 5483103 }
                case 57 { z := 3192354 }
                case 58 { z := 556856 }
                case 59 { z := 3870317 }
                case 60 { z := 2917338 }
                case 61 { z := 1853806 }
                case 62 { z := 3345963 }
                case 63 { z := 1858416 }
                case 64 { z := 3073009 }
                case 65 { z := 1277625 }
                case 66 { z := 5744944 }
                case 67 { z := 3852015 }
                case 68 { z := 4183372 }
                case 69 { z := 5157610 }
                case 70 { z := 5258977 }
                case 71 { z := 8106357 }
                case 72 { z := 2508980 }
                case 73 { z := 2028118 }
                case 74 { z := 1937570 }
                case 75 { z := 4564692 }
                case 76 { z := 2811291 }
                case 77 { z := 5396636 }
                case 78 { z := 7270901 }
                case 79 { z := 4158088 }
                case 80 { z := 1528066 }
                case 81 { z := 482649 }
                case 82 { z := 1148858 }
                case 83 { z := 5418153 }
                case 84 { z := 7814814 }
                case 85 { z := 169688 }
                case 86 { z := 2462444 }
                case 87 { z := 5046034 }
                case 88 { z := 4213992 }
                case 89 { z := 4892034 }
                case 90 { z := 1987814 }
                case 91 { z := 5183169 }
                case 92 { z := 1736313 }
                case 93 { z := 235407 }
                case 94 { z := 5130263 }
                case 95 { z := 3258457 }
                case 96 { z := 5801164 }
                case 97 { z := 1787943 }
                case 98 { z := 5989328 }
                case 99 { z := 6125690 }
                case 100 { z := 3482206 }
                case 101 { z := 4197502 }
                case 102 { z := 7080401 }
                case 103 { z := 6018354 }
                case 104 { z := 7062739 }
                case 105 { z := 2461387 }
                case 106 { z := 3035980 }
                case 107 { z := 621164 }
                case 108 { z := 3901472 }
                case 109 { z := 7153756 }
                case 110 { z := 2925816 }
                case 111 { z := 3374250 }
                case 112 { z := 1356448 }
                case 113 { z := 5604662 }
                case 114 { z := 2683270 }
                case 115 { z := 5601629 }
                case 116 { z := 4912752 }
                case 117 { z := 2312838 }
                case 118 { z := 7727142 }
                case 119 { z := 7921254 }
                case 120 { z := 348812 }
                case 121 { z := 8052569 }
                case 122 { z := 1011223 }
                case 123 { z := 6026202 }
                case 124 { z := 4561790 }
                case 125 { z := 6458164 }
                case 126 { z := 6143691 }
                case 127 { z := 1744507 }
                case 128 { z := 1753 }
                case 129 { z := 6444997 }
                case 130 { z := 5720892 }
                case 131 { z := 6924527 }
                case 132 { z := 2660408 }
                case 133 { z := 6600190 }
                case 134 { z := 8321269 }
                case 135 { z := 2772600 }
                case 136 { z := 1182243 }
                case 137 { z := 87208 }
                case 138 { z := 636927 }
                case 139 { z := 4415111 }
                case 140 { z := 4423672 }
                case 141 { z := 6084020 }
                case 142 { z := 5095502 }
                case 143 { z := 4663471 }
                case 144 { z := 8352605 }
                case 145 { z := 822541 }
                case 146 { z := 1009365 }
                case 147 { z := 5926272 }
                case 148 { z := 6400920 }
                case 149 { z := 1596822 }
                case 150 { z := 4423473 }
                case 151 { z := 4620952 }
                case 152 { z := 6695264 }
                case 153 { z := 4969849 }
                case 154 { z := 2678278 }
                case 155 { z := 4611469 }
                case 156 { z := 4829411 }
                case 157 { z := 635956 }
                case 158 { z := 8129971 }
                case 159 { z := 5925040 }
                case 160 { z := 4234153 }
                case 161 { z := 6607829 }
                case 162 { z := 2192938 }
                case 163 { z := 6653329 }
                case 164 { z := 2387513 }
                case 165 { z := 4768667 }
                case 166 { z := 8111961 }
                case 167 { z := 5199961 }
                case 168 { z := 3747250 }
                case 169 { z := 2296099 }
                case 170 { z := 1239911 }
                case 171 { z := 4541938 }
                case 172 { z := 3195676 }
                case 173 { z := 2642980 }
                case 174 { z := 1254190 }
                case 175 { z := 8368000 }
                case 176 { z := 2998219 }
                case 177 { z := 141835 }
                case 178 { z := 8291116 }
                case 179 { z := 2513018 }
                case 180 { z := 7025525 }
                case 181 { z := 613238 }
                case 182 { z := 7070156 }
                case 183 { z := 6161950 }
                case 184 { z := 7921677 }
                case 185 { z := 6458423 }
                case 186 { z := 4040196 }
                case 187 { z := 4908348 }
                case 188 { z := 2039144 }
                case 189 { z := 6500539 }
                case 190 { z := 7561656 }
                case 191 { z := 6201452 }
                case 192 { z := 6757063 }
                case 193 { z := 2105286 }
                case 194 { z := 6006015 }
                case 195 { z := 6346610 }
                case 196 { z := 586241 }
                case 197 { z := 7200804 }
                case 198 { z := 527981 }
                case 199 { z := 5637006 }
                case 200 { z := 6903432 }
                case 201 { z := 1994046 }
                case 202 { z := 2491325 }
                case 203 { z := 6987258 }
                case 204 { z := 507927 }
                case 205 { z := 7192532 }
                case 206 { z := 7655613 }
                case 207 { z := 6545891 }
                case 208 { z := 5346675 }
                case 209 { z := 8041997 }
                case 210 { z := 2647994 }
                case 211 { z := 3009748 }
                case 212 { z := 5767564 }
                case 213 { z := 4148469 }
                case 214 { z := 749577 }
                case 215 { z := 4357667 }
                case 216 { z := 3980599 }
                case 217 { z := 2569011 }
                case 218 { z := 6764887 }
                case 219 { z := 1723229 }
                case 220 { z := 1665318 }
                case 221 { z := 2028038 }
                case 222 { z := 1163598 }
                case 223 { z := 5011144 }
                case 224 { z := 3994671 }
                case 225 { z := 8368538 }
                case 226 { z := 7009900 }
                case 227 { z := 3020393 }
                case 228 { z := 3363542 }
                case 229 { z := 214880 }
                case 230 { z := 545376 }
                case 231 { z := 7609976 }
                case 232 { z := 3105558 }
                case 233 { z := 7277073 }
                case 234 { z := 508145 }
                case 235 { z := 7826699 }
                case 236 { z := 860144 }
                case 237 { z := 3430436 }
                case 238 { z := 140244 }
                case 239 { z := 6866265 }
                case 240 { z := 6195333 }
                case 241 { z := 3123762 }
                case 242 { z := 2358373 }
                case 243 { z := 6187330 }
                case 244 { z := 5365997 }
                case 245 { z := 6663603 }
                case 246 { z := 2926054 }
                case 247 { z := 7987710 }
                case 248 { z := 8077412 }
                case 249 { z := 3531229 }
                case 250 { z := 4405932 }
                case 251 { z := 4606686 }
                case 252 { z := 1900052 }
                case 253 { z := 7598542 }
                case 254 { z := 1054478 }
                case 255 { z := 7648983 }
            }
        }
    }
}
